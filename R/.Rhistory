All_Data$Employment_Info_4 )
All_Data$Employment_Info_6    <- ifelse(is.na(All_Data$Employment_Info_6),
mean(na.omit(All_Data$Employment_Info_6)),
All_Data$Employment_Info_6 )
All_Data$Insurance_History_5    <- ifelse(is.na(All_Data$Insurance_History_5),
mean(na.omit(All_Data$Insurance_History_5)),
All_Data$Insurance_History_5 )
All_Data$Family_Hist_2    <- ifelse(is.na(All_Data$Family_Hist_2),
mean(na.omit(All_Data$Family_Hist_2)),
All_Data$Family_Hist_2 )
All_Data$Family_Hist_3    <- ifelse(is.na(All_Data$Family_Hist_3),
mean(na.omit(All_Data$Family_Hist_3)),
All_Data$Family_Hist_3 )
All_Data$Family_Hist_4    <- ifelse(is.na(All_Data$Family_Hist_4),
mean(na.omit(All_Data$Family_Hist_4)),
All_Data$Family_Hist_4 )
All_Data$Medical_History_1    <- ifelse(is.na(All_Data$Medical_History_1),
mean(na.omit(All_Data$Medical_History_1)),
All_Data$Medical_History_1 )
All_Data$Medical_History_15    <- ifelse(is.na(All_Data$Medical_History_15),
mean(na.omit(All_Data$Medical_History_15)),
All_Data$Medical_History_15 )
All_Data$Family_Hist_5    <- ifelse(is.na(All_Data$Family_Hist_5),
mean(na.omit(All_Data$Family_Hist_5)),
All_Data$Family_Hist_5 )
All_Data$Medical_History_24    <- ifelse(is.na(All_Data$Medical_History_24),
mean(na.omit(All_Data$Medical_History_24)),
All_Data$Medical_History_24 )
All_Data$Medical_History_32    <- ifelse(is.na(All_Data$Medical_History_32),
mean(na.omit(All_Data$Medical_History_32)),
All_Data$Medical_History_32 )
All_Data$Medical_History_10    <- ifelse(is.na(All_Data$Medical_History_10),
mean(na.omit(All_Data$Medical_History_10)),
All_Data$Medical_History_10 )
summary(All_Data$Medical_History_10)
All_Data$Medical_History_10    <- ifelse(is.na(All_Data$Medical_History_10),
mean(na.omit(All_Data$Medical_History_10)),
All_Data$Medical_History_10 )
str(All_Data, list.len=ncol(All_Data))
All_Data_fulfill_bk <- All_Data
All_Data.tmp <- dummyVars(~., data=All_Data)
All_Data.dummy <- as.data.frame(predict(All_Data.tmp, All_Data))
str(All_Data.dummy, list.len=ncol(All_Data.dummy))
summary(All_Data.dummy)
All_Data.dummy.scale <- scale(All_Data.dummy)
str(All_Data.dummy.scale)
All_Data.dummy.scale
All_Data.dummy.scale <- data.frame(scale(All_Data.dummy))
str(All_Data.dummy.scale)
summary(All_Data.dummy.scale)
summary(All_Data)
summary(All_Data.dummy)
str(All_Data.dummy$Medical_History_1)
summary(All_Data.dummy$Medical_History_1)
test <- scale(All_Data.dummy$Medical_History_1,
center = min(All_Data.dummy$Medical_History_1),
scale = max(All_Data.dummy$Medical_History_1) - min(All_Data.dummy$Medical_History_1)  )
summary(test)
test <- read.csv("data//test.csv", header=T)
test$Product_Info_1      <-as.factor(test$Product_Info_1)
test$Product_Info_2      <-as.factor(test$Product_Info_2)
test$Product_Info_3      <-as.factor(test$Product_Info_3)
test$Product_Info_5      <-as.factor(test$Product_Info_5)
test$Product_Info_6      <-as.factor(test$Product_Info_6)
test$Product_Info_7      <-as.factor(test$Product_Info_7)
test$Employment_Info_2   <-as.factor(test$Employment_Info_2)
test$Employment_Info_3   <-as.factor(test$Employment_Info_3)
test$Employment_Info_5   <-as.factor(test$Employment_Info_5)
test$InsuredInfo_1       <-as.factor(test$InsuredInfo_1)
test$InsuredInfo_2       <-as.factor(test$InsuredInfo_2)
test$InsuredInfo_3       <-as.factor(test$InsuredInfo_3)
test$InsuredInfo_4       <-as.factor(test$InsuredInfo_4)
test$InsuredInfo_5       <-as.factor(test$InsuredInfo_5)
test$InsuredInfo_6       <-as.factor(test$InsuredInfo_6)
test$InsuredInfo_7       <-as.factor(test$InsuredInfo_7)
test$Insurance_History_1 <-as.factor(test$Insurance_History_1)
test$Insurance_History_2 <-as.factor(test$Insurance_History_2)
test$Insurance_History_3 <-as.factor(test$Insurance_History_3)
test$Insurance_History_4 <-as.factor(test$Insurance_History_4)
test$Insurance_History_7 <-as.factor(test$Insurance_History_7)
test$Insurance_History_8 <-as.factor(test$Insurance_History_8)
test$Insurance_History_9 <-as.factor(test$Insurance_History_9)
test$Family_Hist_1       <-as.factor(test$Family_Hist_1)
test$Medical_History_2   <-as.factor(test$Medical_History_2)
test$Medical_History_3   <-as.factor(test$Medical_History_3)
test$Medical_History_4   <-as.factor(test$Medical_History_4)
test$Medical_History_5   <-as.factor(test$Medical_History_5)
test$Medical_History_6   <-as.factor(test$Medical_History_6)
test$Medical_History_7   <-as.factor(test$Medical_History_7)
test$Medical_History_8   <-as.factor(test$Medical_History_8)
test$Medical_History_9   <-as.factor(test$Medical_History_9)
test$Medical_History_10  <-as.factor(test$Medical_History_10)
test$Medical_History_11  <-as.factor(test$Medical_History_11)
test$Medical_History_12  <-as.factor(test$Medical_History_12)
test$Medical_History_13  <-as.factor(test$Medical_History_13)
test$Medical_History_14  <-as.factor(test$Medical_History_14)
test$Medical_History_16  <-as.factor(test$Medical_History_16)
test$Medical_History_17  <-as.factor(test$Medical_History_17)
test$Medical_History_18  <-as.factor(test$Medical_History_18)
test$Medical_History_19  <-as.factor(test$Medical_History_19)
test$Medical_History_20  <-as.factor(test$Medical_History_20)
test$Medical_History_21  <-as.factor(test$Medical_History_21)
test$Medical_History_22  <-as.factor(test$Medical_History_22)
test$Medical_History_23  <-as.factor(test$Medical_History_23)
test$Medical_History_25  <-as.factor(test$Medical_History_25)
test$Medical_History_26  <-as.factor(test$Medical_History_26)
test$Medical_History_27  <-as.factor(test$Medical_History_27)
test$Medical_History_28  <-as.factor(test$Medical_History_28)
test$Medical_History_29  <-as.factor(test$Medical_History_29)
test$Medical_History_30  <-as.factor(test$Medical_History_30)
test$Medical_History_31  <-as.factor(test$Medical_History_31)
test$Medical_History_33  <-as.factor(test$Medical_History_33)
test$Medical_History_34  <-as.factor(test$Medical_History_34)
test$Medical_History_35  <-as.factor(test$Medical_History_35)
test$Medical_History_36  <-as.factor(test$Medical_History_36)
test$Medical_History_37  <-as.factor(test$Medical_History_37)
test$Medical_History_38  <-as.factor(test$Medical_History_38)
test$Medical_History_39  <-as.factor(test$Medical_History_39)
test$Medical_History_40  <-as.factor(test$Medical_History_40)
test$Medical_History_41  <-as.factor(test$Medical_History_41)
test.his1 <- scale(All_Data.dummy$Medical_History_1,
center = min(All_Data.dummy$Medical_History_1),
scale = max(All_Data.dummy$Medical_History_1) - min(All_Data.dummy$Medical_History_1)  )
summary(test.his1)
summary(All_Data.dummy[,1])
summary(All_Data.dummy)
class(All_Data.dummy$Medical_History_1)
str(d)
str(data)
str(d)
str(All_Data)
features<-colnames(All_Data.dummy)[!(colnames(All_Data.dummy) %in% c("Id","Response"))]
features
features<-colnames(All_Data.dummy)[!(colnames(All_Data.dummy) %in% c("Id","Response","Train_Flag"))]
features
features<-colnames(All_Data)[!(colnames(All_Data) %in% c("Id","Response","Train_Flag"))]
features
All_Data[[Medical_History_10]]
All_Data[["Medical_History_10"]]
features
All_Data.scl <- All_Data$Id
str(All_Data.scl)
All_Data.scl <- data.frame(Id=All_Data$Id)
str(All_Data.scl)
str(All_Data)
for (f in features) {
if (class(train[[f]])!="Factor") {
f
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
}
}
for (f in features) {
if (class(All_Data[[f]])!="Factor") {
f
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
}
}
for (f in features) {
if (class(All_Data[[f]])!="Factor") {
cat(f)
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
}
}
for (f in features) {
if (class(All_Data[[f]])!="Factor") {
cat(f, "Â¥n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
}
}
for (f in features) {
if (class(All_Data[[f]])!="Factor") {
cat(f, "\n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
}
}
str(All_Data)
for (f in features) {
if (class(All_Data[[f]])!="Factor") {
cat(f,  class(All_Data[[f]]) ,  "\n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
}
}
for (f in features) {
if (class(All_Data[[f]])!="factor") {
cat(f,  class(All_Data[[f]]) ,  "\n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
}
}
test.his1[["tuika"]] <- a
test.his1[["tuika"]] <- 1
str(test.his1)
for (f in features) {
if (class(All_Data[[f]])!="factor") {
cat(f,  class(All_Data[[f]]),"normalizing process wil be done. \n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
All_Data.scl[[f]] <- scale(All_Data[[f]],
center = min(All_Data[[f]]),
scale = max(All_Data[[f]]) - min(All_Data[[f]]))
}
}
str(All_Data.scl)
head(All_Data.scl, 5)
head(All_Data.scl, 10)
summary(All_Data.dummy.scale)
summary(All_Data.scl)
All_Data.scl <- data.frame(Id=All_Data$Id)
All_Data.scl
for (f in features) {
if (class(All_Data[[f]])!="factor") {
cat(f,  class(All_Data[[f]]),"normalizing process wil be done. \n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
All_Data.scl[[f]] <- scale(All_Data[[f]],
center = min(All_Data[[f]]),
scale = max(All_Data[[f]]) - min(All_Data[[f]]))
}else {
cat(f, class(All_Data[[f]]),"nothin to do \n")
All_Data.scl[[f]] <- All_Data[[f]]
}
}
str
All_Data.scl <- data.frame(Id=All_Data$Id)
for (f in features) {
if (class(All_Data[[f]])!="factor") {
cat(f,  class(All_Data[[f]]),":normalizing process wil be done. \n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
All_Data.scl[[f]] <- scale(All_Data[[f]],
center = min(All_Data[[f]]),
scale = max(All_Data[[f]]) - min(All_Data[[f]]))
}else {
cat(f, class(All_Data[[f]]),":nothing to do \n")
All_Data.scl[[f]] <- All_Data[[f]]
}
}
All_Data.scl <- data.frame(Id=All_Data$Id, Response=All_Data$Response, Train_Flag=All_Data$Train_Flag)
for (f in features) {
if (class(All_Data[[f]])!="factor") {
cat(f,  class(All_Data[[f]]),":normalizing process wil be done. \n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
All_Data.scl[[f]] <- scale(All_Data[[f]],
center = min(All_Data[[f]]),
scale = max(All_Data[[f]]) - min(All_Data[[f]]))
}else {
cat(f, class(All_Data[[f]]),":nothing to do \n")
All_Data.scl[[f]] <- All_Data[[f]]
}
}
str(All_Data.scl)
All_Data.scl <- data.frame(Id=All_Data$Id, Response=All_Data$Response, Train_Flag=All_Data$Train_Flag)
for (f in features) {
if (class(All_Data[[f]])!="factor") {
cat(f,  class(All_Data[[f]]),":normalizing process wil be done. \n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
All_Data.scl[[f]] <- as.integer(scale(All_Data[[f]],
center = min(All_Data[[f]]),
scale = max(All_Data[[f]]) - min(All_Data[[f]])) )
}else {
cat(f, class(All_Data[[f]]),":nothing to do \n")
All_Data.scl[[f]] <- All_Data[[f]]
}
}
str(All_Data.scl)
All_Data.scl <- data.frame(Id=All_Data$Id, Response=All_Data$Response, Train_Flag=All_Data$Train_Flag)
for (f in features) {
if (class(All_Data[[f]])!="factor") {
cat(f,  class(All_Data[[f]]),":normalizing process wil be done. \n")
#train[[f]] <- as.integer(factor(train[[f]], levels=levels))
All_Data.scl[[f]] <- as.numeric(scale(All_Data[[f]],
center = min(All_Data[[f]]),
scale = max(All_Data[[f]]) - min(All_Data[[f]])) )
}else {
cat(f, class(All_Data[[f]]),":nothing to do \n")
All_Data.scl[[f]] <- All_Data[[f]]
}
}
str(All_Data.scl)
summary(All_Data.scl)
str(All_Data.scl)
All_Data.tmp <- dummyVars(~., data=All_Data.scl)
All_Data.dummy <- as.data.frame(predict(All_Data.tmp, All_Data.scl))
summary(All_Data.dummy)
d <- read.csv("data//train.csv", header=T)
d$Product_Info_1      <-as.factor(d$Product_Info_1)
d$Product_Info_2      <-as.factor(d$Product_Info_2)
d$Product_Info_3      <-as.factor(d$Product_Info_3)
d$Product_Info_5      <-as.factor(d$Product_Info_5)
d$Product_Info_6      <-as.factor(d$Product_Info_6)
d$Product_Info_7      <-as.factor(d$Product_Info_7)
d$Employment_Info_2   <-as.factor(d$Employment_Info_2)
d$Employment_Info_3   <-as.factor(d$Employment_Info_3)
d$Employment_Info_5   <-as.factor(d$Employment_Info_5)
d$InsuredInfo_1       <-as.factor(d$InsuredInfo_1)
d$InsuredInfo_2       <-as.factor(d$InsuredInfo_2)
d$InsuredInfo_3       <-as.factor(d$InsuredInfo_3)
d$InsuredInfo_4       <-as.factor(d$InsuredInfo_4)
d$InsuredInfo_5       <-as.factor(d$InsuredInfo_5)
d$InsuredInfo_6       <-as.factor(d$InsuredInfo_6)
d$InsuredInfo_7       <-as.factor(d$InsuredInfo_7)
d$Insurance_History_1 <-as.factor(d$Insurance_History_1)
d$Insurance_History_2 <-as.factor(d$Insurance_History_2)
d$Insurance_History_3 <-as.factor(d$Insurance_History_3)
d$Insurance_History_4 <-as.factor(d$Insurance_History_4)
d$Insurance_History_7 <-as.factor(d$Insurance_History_7)
d$Insurance_History_8 <-as.factor(d$Insurance_History_8)
d$Insurance_History_9 <-as.factor(d$Insurance_History_9)
d$Family_Hist_1       <-as.factor(d$Family_Hist_1)
d$Medical_History_2   <-as.factor(d$Medical_History_2)
d$Medical_History_3   <-as.factor(d$Medical_History_3)
d$Medical_History_4   <-as.factor(d$Medical_History_4)
d$Medical_History_5   <-as.factor(d$Medical_History_5)
d$Medical_History_6   <-as.factor(d$Medical_History_6)
d$Medical_History_7   <-as.factor(d$Medical_History_7)
d$Medical_History_8   <-as.factor(d$Medical_History_8)
d$Medical_History_9   <-as.factor(d$Medical_History_9)
d$Medical_History_10  <-as.factor(d$Medical_History_10)
d$Medical_History_11  <-as.factor(d$Medical_History_11)
d$Medical_History_12  <-as.factor(d$Medical_History_12)
d$Medical_History_13  <-as.factor(d$Medical_History_13)
d$Medical_History_14  <-as.factor(d$Medical_History_14)
d$Medical_History_16  <-as.factor(d$Medical_History_16)
d$Medical_History_17  <-as.factor(d$Medical_History_17)
d$Medical_History_18  <-as.factor(d$Medical_History_18)
d$Medical_History_19  <-as.factor(d$Medical_History_19)
d$Medical_History_20  <-as.factor(d$Medical_History_20)
d$Medical_History_21  <-as.factor(d$Medical_History_21)
d$Medical_History_22  <-as.factor(d$Medical_History_22)
d$Medical_History_23  <-as.factor(d$Medical_History_23)
d$Medical_History_25  <-as.factor(d$Medical_History_25)
d$Medical_History_26  <-as.factor(d$Medical_History_26)
d$Medical_History_27  <-as.factor(d$Medical_History_27)
d$Medical_History_28  <-as.factor(d$Medical_History_28)
d$Medical_History_29  <-as.factor(d$Medical_History_29)
d$Medical_History_30  <-as.factor(d$Medical_History_30)
d$Medical_History_31  <-as.factor(d$Medical_History_31)
d$Medical_History_33  <-as.factor(d$Medical_History_33)
d$Medical_History_34  <-as.factor(d$Medical_History_34)
d$Medical_History_35  <-as.factor(d$Medical_History_35)
d$Medical_History_36  <-as.factor(d$Medical_History_36)
d$Medical_History_37  <-as.factor(d$Medical_History_37)
d$Medical_History_38  <-as.factor(d$Medical_History_38)
d$Medical_History_39  <-as.factor(d$Medical_History_39)
d$Medical_History_40  <-as.factor(d$Medical_History_40)
d$Medical_History_41  <-as.factor(d$Medical_History_41)
#d$Response            <-as.factor(d$Response)
str(d, list.len=ncol(d))
#----------------------------------------------------
test <- read.csv("data//test.csv", header=T)
str(test, list.len=ncol(test))
test$Product_Info_1      <-as.factor(test$Product_Info_1)
test$Product_Info_2      <-as.factor(test$Product_Info_2)
test$Product_Info_3      <-as.factor(test$Product_Info_3)
test$Product_Info_5      <-as.factor(test$Product_Info_5)
test$Product_Info_6      <-as.factor(test$Product_Info_6)
test$Product_Info_7      <-as.factor(test$Product_Info_7)
test$Employment_Info_2   <-as.factor(test$Employment_Info_2)
test$Employment_Info_3   <-as.factor(test$Employment_Info_3)
test$Employment_Info_5   <-as.factor(test$Employment_Info_5)
test$InsuredInfo_1       <-as.factor(test$InsuredInfo_1)
test$InsuredInfo_2       <-as.factor(test$InsuredInfo_2)
test$InsuredInfo_3       <-as.factor(test$InsuredInfo_3)
test$InsuredInfo_4       <-as.factor(test$InsuredInfo_4)
test$InsuredInfo_5       <-as.factor(test$InsuredInfo_5)
test$InsuredInfo_6       <-as.factor(test$InsuredInfo_6)
test$InsuredInfo_7       <-as.factor(test$InsuredInfo_7)
test$Insurance_History_1 <-as.factor(test$Insurance_History_1)
test$Insurance_History_2 <-as.factor(test$Insurance_History_2)
test$Insurance_History_3 <-as.factor(test$Insurance_History_3)
test$Insurance_History_4 <-as.factor(test$Insurance_History_4)
test$Insurance_History_7 <-as.factor(test$Insurance_History_7)
test$Insurance_History_8 <-as.factor(test$Insurance_History_8)
test$Insurance_History_9 <-as.factor(test$Insurance_History_9)
test$Family_Hist_1       <-as.factor(test$Family_Hist_1)
test$Medical_History_2   <-as.factor(test$Medical_History_2)
test$Medical_History_3   <-as.factor(test$Medical_History_3)
test$Medical_History_4   <-as.factor(test$Medical_History_4)
test$Medical_History_5   <-as.factor(test$Medical_History_5)
test$Medical_History_6   <-as.factor(test$Medical_History_6)
test$Medical_History_7   <-as.factor(test$Medical_History_7)
test$Medical_History_8   <-as.factor(test$Medical_History_8)
test$Medical_History_9   <-as.factor(test$Medical_History_9)
test$Medical_History_10  <-as.factor(test$Medical_History_10)
test$Medical_History_11  <-as.factor(test$Medical_History_11)
test$Medical_History_12  <-as.factor(test$Medical_History_12)
test$Medical_History_13  <-as.factor(test$Medical_History_13)
test$Medical_History_14  <-as.factor(test$Medical_History_14)
test$Medical_History_16  <-as.factor(test$Medical_History_16)
test$Medical_History_17  <-as.factor(test$Medical_History_17)
test$Medical_History_18  <-as.factor(test$Medical_History_18)
test$Medical_History_19  <-as.factor(test$Medical_History_19)
test$Medical_History_20  <-as.factor(test$Medical_History_20)
test$Medical_History_21  <-as.factor(test$Medical_History_21)
test$Medical_History_22  <-as.factor(test$Medical_History_22)
test$Medical_History_23  <-as.factor(test$Medical_History_23)
test$Medical_History_25  <-as.factor(test$Medical_History_25)
test$Medical_History_26  <-as.factor(test$Medical_History_26)
test$Medical_History_27  <-as.factor(test$Medical_History_27)
test$Medical_History_28  <-as.factor(test$Medical_History_28)
test$Medical_History_29  <-as.factor(test$Medical_History_29)
test$Medical_History_30  <-as.factor(test$Medical_History_30)
test$Medical_History_31  <-as.factor(test$Medical_History_31)
test$Medical_History_33  <-as.factor(test$Medical_History_33)
test$Medical_History_34  <-as.factor(test$Medical_History_34)
test$Medical_History_35  <-as.factor(test$Medical_History_35)
test$Medical_History_36  <-as.factor(test$Medical_History_36)
test$Medical_History_37  <-as.factor(test$Medical_History_37)
test$Medical_History_38  <-as.factor(test$Medical_History_38)
test$Medical_History_39  <-as.factor(test$Medical_History_39)
test$Medical_History_40  <-as.factor(test$Medical_History_40)
test$Medical_History_41  <-as.factor(test$Medical_History_41)
d$Train_Flag    <- 1  #Add in a flag to identify if observations fall in train data, 1 train, 0 test
test$Response   <- NA #Add in a column for Response in the test data and initialize to NA
test$Train_Flag <- 0  #Add in a flag to identify if observations fall in train data, 1 train, 0 test
All_Data <- rbind(d,test) #79,146 observations, 129 variables
All_Data_bk <- All_Data
All_Data$Employment_Info_1    <- ifelse(is.na(All_Data$Employment_Info_1),
mean(na.omit(All_Data$Employment_Info_1)),
All_Data$Employment_Info_1 )
All_Data$Employment_Info_4    <- ifelse(is.na(All_Data$Employment_Info_4),
mean(na.omit(All_Data$Employment_Info_4)),
All_Data$Employment_Info_4 )
All_Data$Employment_Info_6    <- ifelse(is.na(All_Data$Employment_Info_6),
mean(na.omit(All_Data$Employment_Info_6)),
All_Data$Employment_Info_6 )
All_Data$Insurance_History_5    <- ifelse(is.na(All_Data$Insurance_History_5),
mean(na.omit(All_Data$Insurance_History_5)),
All_Data$Insurance_History_5 )
All_Data$Family_Hist_2    <- ifelse(is.na(All_Data$Family_Hist_2),
mean(na.omit(All_Data$Family_Hist_2)),
All_Data$Family_Hist_2 )
All_Data$Family_Hist_3    <- ifelse(is.na(All_Data$Family_Hist_3),
mean(na.omit(All_Data$Family_Hist_3)),
All_Data$Family_Hist_3 )
All_Data$Family_Hist_4    <- ifelse(is.na(All_Data$Family_Hist_4),
mean(na.omit(All_Data$Family_Hist_4)),
All_Data$Family_Hist_4 )
All_Data$Medical_History_1    <- ifelse(is.na(All_Data$Medical_History_1),
mean(na.omit(All_Data$Medical_History_1)),
All_Data$Medical_History_1 )
All_Data$Medical_History_15    <- ifelse(is.na(All_Data$Medical_History_15),
mean(na.omit(All_Data$Medical_History_15)),
All_Data$Medical_History_15 )
All_Data$Family_Hist_5    <- ifelse(is.na(All_Data$Family_Hist_5),
mean(na.omit(All_Data$Family_Hist_5)),
All_Data$Family_Hist_5 )
All_Data$Medical_History_24    <- ifelse(is.na(All_Data$Medical_History_24),
mean(na.omit(All_Data$Medical_History_24)),
All_Data$Medical_History_24 )
All_Data$Medical_History_32    <- ifelse(is.na(All_Data$Medical_History_32),
mean(na.omit(All_Data$Medical_History_32)),
All_Data$Medical_History_32 )
All_Data$Medical_History_10    <- ifelse(is.na(All_Data$Medical_History_10),
mean(na.omit(All_Data$Medical_History_10)),
All_Data$Medical_History_10 )
All_Data$Medical_History_10    <- ifelse(is.na(All_Data$Medical_History_10),
mean(na.omit(All_Data$Medical_History_10)),
All_Data$Medical_History_10 )
features<-colnames(All_Data)[!(colnames(All_Data) %in% c("Id","Response","Train_Flag"))]
All_Data.scl <- data.frame(Id=All_Data$Id, Response=All_Data$Response, Train_Flag=All_Data$Train_Flag)
for (f in features) {
if (class(All_Data[[f]])!="factor") {
cat(f,  class(All_Data[[f]]),":normalizing process wil be done. \n")
All_Data.scl[[f]] <- as.numeric(scale(All_Data[[f]],
center = min(All_Data[[f]]),
scale = max(All_Data[[f]]) - min(All_Data[[f]])) )
}else {
cat(f, class(All_Data[[f]]),":nothing to do \n")
All_Data.scl[[f]] <- All_Data[[f]]
}
}
All_Data.tmp <- dummyVars(~., data=All_Data.scl)
All_Data.dummy <- as.data.frame(predict(All_Data.tmp, All_Data.scl))
summary(All_Data.dummy)
All_Data.for.pylearn2 <- as.data.frame(predict(All_Data.tmp, All_Data.scl))
summary(All_Data.for.pylearn2)
str(All_Data.for.pylearn2)
All_Data.for.pylearn2$Response <- ifelse(All_Data.for.pylearn2$Response==1, 0, All_Data.for.pylearn2$Response)
All_Data.for.pylearn2$Response <- ifelse(All_Data.for.pylearn2$Response==2, 1, All_Data.for.pylearn2$Response)
All_Data.for.pylearn2$Response <- ifelse(All_Data.for.pylearn2$Response==3, 2, All_Data.for.pylearn2$Response)
All_Data.for.pylearn2$Response <- ifelse(All_Data.for.pylearn2$Response==4, 3, All_Data.for.pylearn2$Response)
All_Data.for.pylearn2$Response <- ifelse(All_Data.for.pylearn2$Response==5, 4, All_Data.for.pylearn2$Response)
All_Data.for.pylearn2$Response <- ifelse(All_Data.for.pylearn2$Response==6, 5, All_Data.for.pylearn2$Response)
All_Data.for.pylearn2$Response <- ifelse(All_Data.for.pylearn2$Response==7, 6, All_Data.for.pylearn2$Response)
All_Data.for.pylearn2$Response <- ifelse(All_Data.for.pylearn2$Response==8, 7, All_Data.for.pylearn2$Response)
str(All_Data.for.pylearn2)
train.for.pylearn2 <- All_Data.for.pylearn2[All_Data.for.pylearn2$Train_Flag==1, -c(1,3)]  # Remove Id, Train_Flg
str(train.for.pylearn2)
test.for.pylearn2  <- All_Data.for.pylearn2[All_Data.for.pylearn2$Train_Flag==0, -c(1:3)]  # Remove Id, Response, T
test.for.pylearn2  <- All_Data.for.pylearn2[All_Data.for.pylearn2$Train_Flag==0, -c(1,3)]
test.for.pylearn2$Response <- 0
smp_size <- floor(0.8 * nrow(train.for.pylearn2))
set.seed(123)
train_rows <- sample(seq_len(nrow(train.for.pylearn2)), size = smp_size)
train_large  <- train.for.pylearn2[train_rows, ]          # 80% of train data
train_mini   <- train.for.pylearn2[sample(1:nrow(train.for.pylearn2), 1000), ]
valid_large  <- train.for.pylearn2[-train_rows, ]         # rest data (20%)
valid <- valid_large[sample(1:nrow(valid_large),1000),]
test_mini    <- test.for.pylearn2[c(1:10),]
write.csv(train_large,       "out_for_pylearn2/train.csv",       row.names=F)
write.csv(train_mini,        "out_for_pylearn2/train_mini.csv",  row.names=F)
write.csv(valid,             "out_for_pylearn2/valid.csv",       row.names=F)
write.csv(test.for.pylearn2, "out_for_pylearn2/test.csv",        row.names=F)
write.csv(test_mini,         "out_for_pylearn2/test_mini.csv",   row.names=F)
str(train.for.pylearn2)
summary(All_Data.for.pylearn2)
str(train_large)
summary(train_large)
write.csv(train_large,       "out_for_pylearn2/train.csv",       row.names=F)
nrow(valid_large)
write.csv(valid_large,       "out_for_pylearn2/valid_large.csv", row.names=F)
write.csv(valid_large,       "out_for_pylearn2/valid.csv", row.names=F)
write.csv(valid,             "out_for_pylearn2/valid_mini.csv",       row.names=F)
save()
nrow(valid)
